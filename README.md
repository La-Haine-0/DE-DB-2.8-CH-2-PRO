# DE-DB-2.8-CH-2-PRO
### Анализ данных продажи товаров
### Описание:
Вы работаете с данными о продажах товаров в магазине и должны выполнить ряд аналитических задач, используя ClickHouse. Ваши задачи включают в себя:
- Агрегация данных:
Вычислите общую сумму продаж по каждой категории товаров за последний месяц.
Определите средний чек покупателей за последний год.
- Промежуточные состояния:
Сначала вычислите средние продажи для каждой категории товаров в течение квартала с использованием -State комбинатора и функции avgState.
Затем объедините промежуточные результаты с использованием -Merge комбинатора, чтобы вычислить общую среднюю продажу за квартал.
- Работа с окнами данных:
Определите топ-5 товаров с наибольшей выручкой за последние 7 дней.
Найдите кумулятивную сумму продаж для каждой категории товаров за последние 3 месяца.
- Оптимизация запросов:
Создайте отчет о продажах за последний год и сохраните его в отдельной таблице с использованием оператора INSERT.
Затем выполните запрос, который объединяет данные из этой таблицы с текущими данными о продажах и вычисляет общую сумму продаж за последний год.
### Примечания:
- Обратитесь к документации по Clickhouse для изучения синтаксиса и возможностей этой СУБД.
- Убедитесь, что SQL-скрипт содержит все необходимые инструкции для создания и настройки витрины, включая создание таблиц, определение ключей индексов и прочих элементов, учтите требования к типам данных и настройкам Clickhouse.
- Предоставьте SQL-скрипт в удобном формате (например, текстовый файл с расширением .sql).